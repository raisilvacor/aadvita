{% extends "base.html" %}

{% block title %}{{ _('Relat√≥rio de Atividades') }} - {{ _('Transpar√™ncia') }} - AADVITA{% endblock %}

{% block content %}
<section class="page-header" aria-labelledby="page-title">
    <div class="container">
        <h1 id="page-title" class="page-title">{{ _('Relat√≥rio de Atividades') }}</h1>
        <p class="page-description">{{ _('Acompanhe as atividades realizadas pela associa√ß√£o e os resultados alcan√ßados') }}</p>
    </div>
</section>

<section class="relatorios-section" aria-labelledby="relatorios-content">
    <div class="container">
        <!-- Formul√°rio de Pesquisa por Data -->
        <div class="search-filter" style="background: #f8f9fa; padding: 1.5rem; border-radius: 8px; margin-bottom: 2rem; border: 1px solid #dee2e6;">
            <form method="GET" action="{{ url_for('relatorios_atividades') }}" style="display: flex; gap: 1rem; align-items: flex-end; flex-wrap: wrap;">
                <div style="flex: 1; min-width: 200px;">
                    <label for="data_inicio" style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: #333;">{{ _('Data Inicial:') }}</label>
                    <input type="date" id="data_inicio" name="data_inicio" value="{{ data_inicio }}" style="width: 100%; padding: 0.75rem; border: 1px solid #ced4da; border-radius: 4px; font-size: 1rem;">
                </div>
                <div style="flex: 1; min-width: 200px;">
                    <label for="data_fim" style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: #333;">{{ _('Data Final:') }}</label>
                    <input type="date" id="data_fim" name="data_fim" value="{{ data_fim }}" style="width: 100%; padding: 0.75rem; border: 1px solid #ced4da; border-radius: 4px; font-size: 1rem;">
                </div>
                <div style="display: flex; gap: 0.5rem;">
                    <button type="submit" style="padding: 0.75rem 1.5rem; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 1rem; font-weight: 600; white-space: nowrap;">{{ _('Pesquisar') }}</button>
                    <a href="{{ url_for('relatorios_atividades') }}" style="padding: 0.75rem 1.5rem; background: #6c757d; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 1rem; font-weight: 600; text-decoration: none; white-space: nowrap; display: inline-block;">{{ _('Limpar') }}</a>
                </div>
            </form>
        </div>
        
        {% if relatorios %}
            <div class="relatorios-list">
                {% for relatorio in relatorios %}
                <div class="relatorio-item">
                    <div class="relatorio-header">
                        <h3>{{ get_text(relatorio, 'titulo') or relatorio.titulo_pt }}</h3>
                        <div class="relatorio-meta">
                            {% if relatorio.periodo_inicio and relatorio.periodo_fim %}
                                <span class="relatorio-date">{{ _('Per√≠odo:') }} {{ relatorio.periodo_inicio.strftime('%d/%m/%Y') }} - {{ relatorio.periodo_fim.strftime('%d/%m/%Y') }}</span>
                            {% elif relatorio.periodo_inicio %}
                                <span class="relatorio-date">{{ _('A partir de') }} {{ relatorio.periodo_inicio.strftime('%d/%m/%Y') }}</span>
                            {% endif %}
                        </div>
                    </div>
                    
                    {% if get_text(relatorio, 'descricao') %}
                        <div class="relatorio-descricao">
                            <p>{{ get_text(relatorio, 'descricao')|limpar_br_nl2br|safe }}</p>
                        </div>
                    {% endif %}
                    
                    {% if get_text(relatorio, 'atividades_realizadas') %}
                        <div class="prestacao-section">
                            <h4>{{ _('Atividades Realizadas:') }}</h4>
                            <p>{{ get_text(relatorio, 'atividades_realizadas')|limpar_br_nl2br|safe }}</p>
                        </div>
                    {% endif %}
                    
                    {% if get_text(relatorio, 'resultados') %}
                        <div class="prestacao-section">
                            <h4>{{ _('Resultados Alcan√ßados:') }}</h4>
                            <p>{{ get_text(relatorio, 'resultados')|limpar_br_nl2br|safe }}</p>
                        </div>
                    {% endif %}
                    
                    {% if relatorio.arquivo or relatorio.arquivo_base64 %}
                        <div class="relatorio-actions">
                            <a href="{{ url_for('relatorio_atividade_arquivo', id=relatorio.id) }}" target="_blank" class="btn btn-primary">
                                <span>üìÑ</span> {{ _('Baixar Documento') }}
                            </a>
                        </div>
                    {% endif %}
                </div>
                {% endfor %}
            </div>
        {% else %}
            <div class="no-data">
                <p>{{ _('Nenhum relat√≥rio de atividades cadastrado no momento.') }}</p>
            </div>
        {% endif %}

        <div class="relatorios-back">
            <a href="{{ url_for('transparencia') }}" class="btn btn-secondary">
                <span>‚Üê</span> {{ _('Voltar para Transpar√™ncia') }}
            </a>
        </div>
    </div>
</section>
{% endblock %}

